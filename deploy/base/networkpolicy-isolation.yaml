# Quarantine NetworkPolicy template - applied dynamically by the detection engine
# to isolate compromised pods. This serves as a reference / default policy.
apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  name: guardian-quarantine-template
  namespace: guardian-system
  labels:
    app.kubernetes.io/name: zero-day-guardian
    app.kubernetes.io/component: quarantine
  annotations:
    guardian.zerodayguardian.io/description: >
      Template for deny-all network policy applied to quarantined pods.
      The detection engine creates per-pod copies targeting pods labeled
      with guardian.zerodayguardian.io/quarantine=true.
spec:
  # Selector matches quarantined pods
  podSelector:
    matchLabels:
      guardian.zerodayguardian.io/quarantine: "true"
  policyTypes:
    - Ingress
    - Egress
  # Empty ingress/egress = deny all traffic
  ingress: []
  egress: []
